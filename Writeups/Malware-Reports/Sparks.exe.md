Malware Type- <span style="color:#c00000">Driver loader</span>

Hashes--->
md5-`181EE63003E5C3EC8C378030286ED7A2`
sha256-`55BFCB784904477EF62EF7E4994DEE42F03D69BFEC3591989513CCCBBA3FC8FE`
<br>

# Initial Detonation
---
![[Pasted image 20230818183254.png]]
Nothing seems to be happening.
<br>

# Static Analysis
----
Strings -
![[Pasted image 20230818233112.png]]
Important strings -

```
C:\Users\Chris\source\newrepos\Spark\Release\DLL.pdb
.NETFramework,Version=v4.7.1
FrameworkDisplayName
.NET Framework 4.7.1
add_AssemblyResolve
Spark.exe
SeLoadDriverPrivilege
\Registry\Machine\System\CurrentControlSet\Services\Driver
\\.\Spark
\\.\PhysicalDrive0
\Device\Spark
\DosDevices\Spark
KmdfLibrary
@\Device\Spark
\DosDevices\Spark
Spark.exe
IFEO.exe
DLL.dll
Driver.sys
Options\mmc.exe
Debugger
Software\Microsoft\Windows NT\CurrentVersion\Image File Execution 
Options\regedit.exe
Software\Microsoft\Windows NT\CurrentVersion\Image File Execution 
Options\msconfig.exe
Software\Microsoft\Windows NT\CurrentVersion\Image File Execution 
Options\taskschd.msc
Software\Microsoft\Windows\CurrentVersion\Policies\System
legalnoticecaption
```
Now opening the file in <span style="color:#ffff00">peview</span>.
![[Pasted image 20230818233550.png]]
This is an portable executable.
![[Pasted image 20230818233721.png]]
The malware is a packed one.
Now opening in <span style="color:#ffff00">pestudio</span>.
![[Pasted image 20230818233933.png]]
This malware is most probably a .NET loader.
![[Pasted image 20230818234013.png]]
![[Pasted image 20230818234027.png]]
![[Pasted image 20230818234046.png]]
![[Pasted image 20230818234109.png]]
<br>

# Dynamic Analysis
-----
### Host Indicators

in <span style="color:#ffff00">procmon</span>.
![[Pasted image 20230818234603.png]]
![[Pasted image 20230818234626.png]]
![[Pasted image 20230818234711.png]]
![[Pasted image 20230818234747.png]]
The malware is a stager for a driver.
![[Pasted image 20230818234857.png]]
![[Pasted image 20230818235111.png]]
The IFEO.exe seems to be a handler for the malware.
It seems to only look for a specific pc . If it isn't found, then it doesn't run.
