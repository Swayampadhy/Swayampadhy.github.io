 Malware type - <span style="color:#c00000">Crypto stealer</span>
 <br>

# Initial Detonation
----
Without network -

Nothing seems to be happening.

![[Pasted image 20230815203851.png]]

With Network-

Same results
![[Pasted image 20230815203942.png]]
<br>

# Static Analysis
----
Strings output - 
![[Pasted image 20230815214350.png]]

```
ntdll.dll
rundll32.exe
GetNativeSystemInfo
ProgramData\
D:\Mktmp\NL1\Release\NL1.pdb
ADVAPI32.dll
ShellExecuteA
ShellExecuteExW
SHELL32.dll
KERNEL32.dll
GetSystemMetrics
USER32.dll
Content-Type: application/x-www-form-urlencoded
Microsoft Internet Explorer
shell32.dll
okernel32.dll
ProgramData\
-16843010
```

Now opening the file in <span style="color:#ffff00">peview</span>.

![[Pasted image 20230815214715.png]]
This is a portable executable for windows systems.
![[Pasted image 20230815215655.png]]
As the virtual size and size of raw data is approximately similar, this must be an unpacked binary.

![[Pasted image 20230815215815.png]]
The huge amount of imports confirm this.

Now we need to further analyse the sample in <span style="color:#ffff00">pestudio</span> . 

![[Pasted image 20230815220635.png]]
The hash values of the sample.

![[Pasted image 20230815220702.png]]
This malware is written in  `Visual C++`  for 32 bit windows systems.
Some malicious indicators of the file-
![[Pasted image 20230815221013.png]]
![[Pasted image 20230815221149.png]]
The malware is importing `WININET.dll` .
![[Pasted image 20230815221222.png]]
27 suspicious imports are present -
![[Pasted image 20230815221304.png]]

Now opening the file in <span style="color:#ffff00">cutter</span>.

![[Pasted image 20230815221629.png]]
The decompiled main function -
![[Pasted image 20230815222559.png]]
The main function -
![[Pasted image 20230815222703.png]]
<br>

# Dynamic Analysis
----
### Network based indicators

Upon clicking the malware, there is a query for the dns server - `mynexa.io`

![[Pasted image 20230816104425.png]]
Then it is making a post request to the site with the pc details-
![[Pasted image 20230816110022.png]]
It then gets a supposed response from inetsim -
![[Pasted image 20230816110133.png]]
We then point this dns address to flare-vm.

		 nano C:\Windows\System32\drivers\etc\hosts

![[Pasted image 20230816110348.png]]

### Host-based indicators

Adding a filter in procmon
![[Pasted image 20230816110515.png]]
Running the malware , we get a lot of processes
![[Pasted image 20230816110607.png]]

![[Pasted image 20230816111419.png]]
![[Pasted image 20230816111521.png]]
No results found.
![[Pasted image 20230816111629.png]]
![[Pasted image 20230816111642.png]]
So a file and a folder are created in `PROGRAMDATA` folder.
![[Pasted image 20230816111826.png]]
![[Pasted image 20230816111915.png]]
Running `gbudn.exe` , we get the following in wireshark.
![[Pasted image 20230816112121.png]]
This binary is the one that is making the post requests.

This must be a <span style="color:#c00000">spyware</span> that targets crypto wallets.

https://cryptoslate.com/this-electrorat-malware-might-be-silently-draining-your-bitcoin/

https://www.coindesk.com/tech/2021/01/06/this-elusive-malware-has-been-targeting-crypto-wallets-for-a-year/

![[Pasted image 20230816121455.png]]