Malware Type - <span style="color:#c00000">wiper</span>
Hashes--->

md5- `5ddd703b2aae461d400658371b621369`
sha256-`29f39766feb395e5b230cb5cad36e6b433a93e56ca240f4df0ada3e9a2f88dc3`
<br>

# Initial Detonation
----
### Without Network-

![[Pasted image 20230816180713.png]]
![[Pasted image 20230816180720.png]]
![[Pasted image 20230816180800.png]]
The whole desktop glitches .
![[Pasted image 20230816181035.png]]
Then the whole windows installation is destroyed but data is recoverable.

### With Network -

same result
<br>

# Static Analysis
-----
### Strings-
![[Pasted image 20230816182819.png]]
Interesting strings-
```
C:\Users\comshop\Documents\Astranizer\Debug\Astranizer.pdb
bin\MSPDB140.DLL
api-ms-win-core-registry-l1-1-0.dll
advapi32.dll
ntdll.dll
\\.\PhysicalDrive0
Astranizer.exe
SOFTWARE\Microsoft\Windows
CONOUT$
```

Now analyzing the malware using <span style="color:#ffff00">peview</span>.
![[Pasted image 20230816183823.png]]
This is a windows PE.
![[Pasted image 20230816184458.png]]
Virtual size almost equal to size of raw data. So this is an unpacked binary.
![[Pasted image 20230816184656.png]]
Plenty of IAT imports confirm that the malware is unpacked.

Now opening the file in <span style="color:#ffff00">pestudio</span>.
![[Pasted image 20230816184843.png]]
Pestudio outputs some malicious indicators of the malware.
![[Pasted image 20230816184925.png]]
![[Pasted image 20230816184951.png]]
The malware is composed up of 9 sections out of which 4 are out of the ordinary.
![[Pasted image 20230816185046.png]]
One suspicious library is used.
![[Pasted image 20230816185113.png]]
20 suspicious imports.
Now opening the file in <span style="color:#ffff00">cutter</span> -
![[Pasted image 20230816185437.png]]

Decompiled main function-
```
int32_t main (void) {

int32_t var_b8h;

int32_t var_b4h;

int32_t var_a8h;

int32_t var_9ch;

int32_t var_90h;

int32_t var_84h;

int32_t var_78h;

HANDLE var_6ch;

HANDLE var_60h;

HANDLE var_54h;

HANDLE var_48h;

HANDLE var_3ch;

HANDLE hThread;

HANDLE hObject;

int32_t var_18h;

int32_t var_ch;

edi = &var_b8h;

ecx = 0x2d;

eax = 0xcccccccc;

memset (edi, eax, ecx);

ecx = data.004a00f1;

fcn_0042eab2 ();

esi = esp;

MessageBoxA (0, " Do you want to run this program??\r\n\r\nThis malware is no joke to destroy to\r\nyour computer and make it unusable.\r\nIf you have epilepsy to see the GDI payloads press NO and delete this program\r\nIf you have a safe environment like Virtual machines to test press YES to start it\r\n\r\nThe creator is not responsible to make a lot of damage\r\nmade to this malware!\r\n\r\nARE YOU SURE DO YOU WANT TO RUN THIS!?", "Astranizer by GetMbr", 0x134);

eax = fcn_0042de19 ();

if (eax != 6) {

esi = esp;

ExitProcess (0);

}

esi = esp;

MessageBoxA (0, "THIS IS THE LAST WARNING\r\n\r\nARE YOU REALLY WANT TO RUN THIS DANGEROUS MALWARE!?\r\nPRESS YES TO START THE DESTRUCTION\r\nOR NO TO EXIT.\r\nARE YOU SURE TO WANT TO START THE DESTRUCTION!?", "LAST WARNING", 0x134);

eax = fcn_0042de19 ();

if (eax != 6) {

esi = esp;

ExitProcess (0);

}

esi = esp;

CreateThread (0, 0, data.0042f1f1, 0, 0, 0);

eax = fcn_0042de19 ();

esi = esp;

Sleep (0x7d0, eax);

fcn_0042de19 ();

esi = esp;

CreateThread (0, 0, data.0042e003, 0, 0, 0);

eax = fcn_0042de19 ();

esi = esp;

Sleep (0xbb8, eax);

fcn_0042de19 ();

fcn_0042d5b3 ();

esi = esp;

CreateThread (0, 0, data.0042d694, 0, 0, 0);

eax = fcn_0042de19 ();

esi = esp;

Sleep (0xcf08, eax);

fcn_0042de19 ();

esi = esp;

eax = hObject;

TerminateThread (eax, 0);

fcn_0042de19 ();

esi = esp;

eax = hObject;

CloseHandle (eax);

fcn_0042de19 ();

fcn_0042ea30 ();

esi = esp;

CreateThread (0, 0, data.0042dc9d, 0, 0, 0);

eax = fcn_0042de19 ();

esi = esp;

Sleep (0xcf08, eax);

fcn_0042de19 ();

fcn_0042eefe ();

esi = esp;

CreateThread (0, 0, data.0042d02c, 0, 0, 0);

eax = fcn_0042de19 ();

esi = esp;

Sleep (0x7530, eax);

fcn_0042de19 ();

esi = esp;

eax = hThread;

TerminateThread (eax, 0);

fcn_0042de19 ();

esi = esp;

eax = hThread;

CloseHandle (eax);

fcn_0042de19 ();

esi = esp;

eax = var_3ch;

TerminateThread (eax, 0);

fcn_0042de19 ();

esi = esp;

eax = var_3ch;

CloseHandle (eax);

fcn_0042de19 ();

fcn_0042c910 ();

esi = esp;

CreateThread (0, 0, data.0042e431, 0, 0, 0);

eax = fcn_0042de19 ();

esi = esp;

CreateThread (0, eax, data.0042eed6, 0, 0, 0);

eax = fcn_0042de19 ();

esi = esp;

Sleep (0x80e8, eax);

fcn_0042de19 ();

esi = esp;

eax = var_54h;

TerminateThread (eax, 0);

fcn_0042de19 ();

esi = esp;

eax = var_54h;

CloseHandle (eax);

fcn_0042de19 ();

esi = esp;

eax = var_48h;

TerminateThread (eax, 0);

fcn_0042de19 ();

esi = esp;

eax = var_48h;

CloseHandle (eax);

fcn_0042de19 ();

fcn_0042f200 ();

esi = esp;

CreateThread (0, 0, data.0042e882, 0, 0, 0);

eax = fcn_0042de19 ();

esi = esp;

Sleep (0xcf08, eax);

fcn_0042de19 ();

esi = esp;

eax = var_60h;

TerminateThread (eax, 0);

fcn_0042de19 ();

esi = esp;

eax = var_60h;

CloseHandle (eax);

fcn_0042de19 ();

fcn_0042db99 ();

esi = esp;

CreateThread (0, 0, data.0042c4ab, 0, 0, 0);

eax = fcn_0042de19 ();

esi = esp;

CreateThread (0, eax, data.0042e431, 0, 0, 0);

eax = fcn_0042de19 ();

esi = esp;

CreateThread (0, eax, data.0042e882, 0, 0, 0);

eax = fcn_0042de19 ();

esi = esp;

CreateThread (0, eax, data.0042eed6, 0, 0, 0);

eax = fcn_0042de19 ();

esi = esp;

CreateThread (0, eax, data.0042e297, 0, 0, 0);

eax = fcn_0042de19 ();

esi = esp;

Sleep (0xcf08, eax);

fcn_0042de19 ();

esi = esp;

CreateThread (0, 0, data.0042c749, 0, 0, 0);

eax = fcn_0042de19 ();

esi = esp;

eax = var_6ch;

TerminateThread (eax, eax);

fcn_0042de19 ();

esi = esp;

eax = var_6ch;

CloseHandle (eax);

fcn_0042de19 ();

esi = esp;

CreateThread (0, 0, data.0042c749, 0, 0, 0);

eax = fcn_0042de19 ();

esi = esp;

Sleep (0x186a0, eax);

eax = fcn_0042de19 ();

eax = 0;

fcn_0042de19 ();

return eax;

}
```
<br>

# Dynamic Analysis
----
### Network Based Indicators-
None

### Host based Indicators -

In <span style="color:#ffff00">tcpview</span>-
nothing

In <span style="color:#ffff00">procmon</span>
![[Pasted image 20230816200515.png]]
![[Pasted image 20230816200648.png]]
A lot of processes are created at once.
![[Pasted image 20230816202830.png]]
The malware creates a device at - `\Device\Harddisk0\DR0` and is writing malicious inputs through it.
