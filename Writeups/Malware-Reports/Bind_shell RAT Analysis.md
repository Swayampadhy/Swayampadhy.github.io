<br>

# Sample Information
------
<b><u>Malware used</b></u>- <font color =Cyan> RAT.Unknown.exe.malz </font>
Type - <span style="color:#c00000">Remote Access Trojan</span>
<br>

# Static Analysis
------
### Floss-
command used-

		floss.exe .\RAT.Unknown.exe.malz > RAT_floss.txt

![[Pasted image 20230726201710.png]]
Output-
![[Pasted image 20230726203429.png]]
<br>

# Initial Detonation
------
![[Pasted image 20230726203907.png]]
The malware detects the sandbox and stops running giving out an error.
<br>

# Dynamic Analysis
------
### Network Analysis-

![[Pasted image 20230726204607.png]]
We see a bunch of http requests made by the malicious exe file. Navigating to the topmost request we get,

![[Pasted image 20230726204752.png]]
The malware is requesting for this web URI.
![[Pasted image 20230726205233.png]]
Then the server responds with an executable namely - <b>msdcorelib.exe</b>.
Now following that http-stream, we get-

![[Pasted image 20230726205459.png]]

![[Pasted image 20230726205715.png]]
<b>Inetsim</b> responded to the request with a default executable. 
<h2><b><u>NOTE</u>-</b></h2>
The binary may not be stored on the system under the same name it is requested. This process is commonly used by red-teamers and malware developers and is known as <font color=green><b>Decoupling</b></font>.
<br>

## Host signature Analysis-

Adding a filter in procmon for the malware executable name-
![[Pasted image 20230726211525.png]]
Then run the exe.
![[Pasted image 20230726212336.png]]
We get a load of processes.Now to track down the downloaded executable,we add another filter to only show file processes.
![[Pasted image 20230726212548.png]]
There's a lot of information. Now we had a file location in strings output.
![[Pasted image 20230726212903.png]]
Adding a filter with that location-
![[Pasted image 20230726213054.png]]
We get some results.
![[Pasted image 20230726213211.png]]
The downloaded executable is saved as <b>mscordll.exe</b>.
![[Pasted image 20230726213458.png]]
This "suspicious" executable has been created in the startup folder. Thus whenever the system starts,the executable is also run.
![[Pasted image 20230726213737.png]]
<br>

## Another set of signatures-

### Internal network signatures on the host

In order to analyse the connections made by the malware internally, <font color=green><b>TCPview</b></font> is used. It is a part of the sysinternals suite.
![[Pasted image 20230726222847.png]]
We need to look out for <font color=green><b>TCP artifacts</b></font> such as open sockets or tcp connections.
![[Pasted image 20230726223816.png]]
We see that the malware has opened up a listening port on TCP : 5555.
Thus we use netcat to connect to the port using the command-

		nc -nv 10.0.0.4 5555

![[Pasted image 20230726224207.png]]
We get a base64 encoded response.Decoding it we get-

![[Pasted image 20230726224508.png]]
So the malware is waiting upon an attacker to run a command.

So <font color=green><b>Command injection</b></font> capability using bind shells is confirmed.