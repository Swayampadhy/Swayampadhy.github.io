Malware Type - <span style="color:#c00000">malicious VBS script</span>

Hashes -->

md5 -> 99ec3237394257cb0b5c24affe458f48
sha256-> ec17f950f6ee9c0c237d93bc0b766aa6e2ab458c70320b534212043128177b51

# Initial Detonation
-----
### Without Network ->

Upon executing the script, a notification pops up
![[Pasted image 20240526192538.png]]
And a text file named Bolbi.txt is created in the Desktop at `C:\Users\Leek0gg\Desktop\Bolbi.txt`
![[Pasted image 20240526192554.png]]

Upon Restarting, an alert pops up in the login screen.
![[Pasted image 20240526192707.png]]

### With Network ->

The script gets a jpg file named - `8ydfdsE.jpg` from `http://i.imgur.com/8ydfdsE.jpg`
![[Pasted image 20240526193502.png]]
and a mp3 file named - `kusifxz.mp3` from `http://pomfcat.000webhostapp.com/kusifxz.mp3`
![[Pasted image 20240526193524.png]]
and lastly an executable named - `rpdbfk.exe` from `http://pomfcat.000webhostapp.com/rpdbfk.exe`
![[Pasted image 20240526193603.png]]
which shortly gets executed.
![[Pasted image 20240526193356.png]]
After restart,
![[Pasted image 20240526192707.png]]
![[Pasted image 20240526194244.png]]
and the machine goes to a black screen which is supposedly the downloaded jpg file and the downloaded mp3 is supposed to play noe.
The pc is unusable.
# Static Analysis
------
### Initial Elevation

![[Pasted image 20240526183202.png]]
The malware checks first if it is running in an elevated context. If it isn't running in an elevated context, it re-runs itself using `runas`. 

### Setting Up Environment Variables and Objects

- Initializes various objects such as the file system object (`fso`) and the Windows Script Host (`WScript.Shell`).
![[Pasted image 20240526183757.png]]

### Main Functions

#### BolbisName

![[Pasted image 20240526184616.png]]
Modifies the registry to:
	1. Set an alternate shell to `notepad.exe` for Safe Mode.
	2. Change the computer name to "Bolbi".
    3. Set a legal notice message on the logon screen indicating the system is compromised.
    4. Change international AM/PM settings to "Bolbi".

#### SlapClap
![[Pasted image 20240526190449.png]]
	Creates directories `C:\Users`, `C:\Users\Public`, and `C:\Users\Public\ghostroot` if they do not exist.

#### Spirit
![[Pasted image 20240526190638.png]]
    Sets the hidden attribute on critical system folders (`C:\Windows`, `C:\Windows\System32`, `C:\Users\Public\ghostroot`, `C:\Program Files`).

#### Message1
![[Pasted image 20240526190729.png]]
Displays a message box with the text: "WE SLAP EVERYDAY! slap slap slap clap clap clap slap slap slap clap clap clap slap slap slap clap clap clap".

#### DownPic
![[Pasted image 20240526190807.png]]
  Downloads an image from `http://i.imgur.com/8ydfdsE.jpg` and saves it to `C:\Users\Public\ghostroot\8ydfdsE.jpg`.

#### DownBolbi
![[Pasted image 20240526190827.png]]
 Downloads an MP3 file from `http://pomfcat.000webhostapp.com/kusifxz.mp3` and saves it to `C:\Users\Public\ghostroot\kusifxz.mp3`.

#### Holder
![[Pasted image 20240526190912.png]]
- Sets the downloaded image as the desktop wallpaper.
- Adds the script to the startup programs to ensure it runs every time the system starts.
- Modifies registry settings to disable task manager, hide file extensions, and restrict various user actions.

#### WrieFuk And RunFuk
![[Pasted image 20240526191307.png]]
![[Pasted image 20240526191421.png]]
Creates and runs a batch file (`KillDora.bat`) that:
        - Changes file associations for `.lnk`, `.scr`, and `.pif` to executable files.
        - Deletes Safe Mode registry keys.
        - Takes ownership of the `C:\Windows` and `C:\Windows\System32` directories and grants full control to all users.
        - Restarts `explorer.exe`.

#### FukYu
![[Pasted image 20240526191349.png]]
Pauses the script for 8 seconds.

#### BolbiMessage
![[Pasted image 20240526191734.png]]
 Creates a script that displays a message box indicating "**Bolbi has made the use of this file forbidden!**".

#### Sound
![[Pasted image 20240526191821.png]]
Creates a script that plays the downloaded MP3 file repeatedly.

#### Write1
![[Pasted image 20240526191846.png]]
Creates a text file on the desktop with the content: "**SLAP SLAP SLAP CLAP CLAP CLAP**".

#### DownBye and RunBye
![[Pasted image 20240526191953.png]]
Downloads and runs an executable file (`rpdbfk.exe`) from `http://pomfcat.000webhostapp.com/rpdbfk.exe`.

#### **CounterRemoval**
![[Pasted image 20240526192045.png]]
- Modifies registry settings to:
    - Redirect execution of various system and antivirus-related executables to display the message box script created earlier.
    - Disable access to certain system tools like `cmd.exe`, `taskmgr.exe`, and `regedit.exe`.
#### **LastChance**
![[Pasted image 20240526192142.png]]
Further restricts user actions by modifying registry settings to hide drives and disable registry tools.

#### **FindDrive and FindFolder**
![[Pasted image 20240526192220.png]]
Recursively searches for drives and folders to spread copies of itself.

#### Cloner
![[Pasted image 20240526192336.png]]
Creates copies of itself in various subdirectories and files.

#### **ExtinguishFile**
![[Pasted image 20240526192418.png]]
Corrupts targeted files by overwriting them.






	