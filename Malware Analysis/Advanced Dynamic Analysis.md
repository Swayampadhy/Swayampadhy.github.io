<br>

# Introduction
-----
<span style="color:#047c3a">Advanced dynamic malware analysis</span> stands for running the malware inside debuggers so that we get complete control over it's execution flow.

A <span style="color:#047c3a">debugger</span> is an application which acts as a broker between the end user and the operating system while the program is running. This enable us to have complete control over the program.
<br>

# x32dbg : Flow And Breakpoints
------
Tools used - <span style="color:#ffff00">x32dbg</span>

Opening the debugger, we are greeted with this window-->

![[Pasted image 20230729144904.png]]

Opening the malware in the debugger-->
![[Pasted image 20230729152211.png]]
On top right , we have the control panel-->
![[Pasted image 20230729152440.png]]

below it is the cpu instructions-->
![[Pasted image 20230729152523.png]]

On it's right, we have the register values-->
![[Pasted image 20230729152708.png]]

On bottom left, the hexdump is shown-->
![[Pasted image 20230729152750.png]]

And on it's right , we have the memory stack which will grow and shrink from time to time-->
![[Pasted image 20230729152851.png]]

Running the program using `F9` we can see that we have entered into the program and stopped at a breakpoint before `DownloadfromURL` entrypoint.

![[Pasted image 20230729153152.png]]
Hitting `F8` we will step over onto the next instruction.
![[Pasted image 20230729153427.png]]
![[Pasted image 20230729153502.png]]
We see that the stack has updated after the `PUSH 14` instruction.

<span style="color:#047c3a">Step into</span> means the debugger will enter the function and return the final value in it.

<span style="color:#047c3a">Step over</span> means the debugger will assume that the function was run and will go over to the next instruction without caring for the returned value.  

Press `F2` to create a breakpoint .  A breakpoint will pause the program whenever the debugger encounters it. Everytime `F9` or run is executed, the debugger will jump onto the next breakpoint.

