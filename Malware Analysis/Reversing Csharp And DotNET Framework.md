<br>

# Sample Details
---
Sample Name-<span style="color:#00b0f0">Malware.cryptlib64.dll</span>
Malware Type- <span style="color:#c00000">C2 Dropper</span>
<br>

# Analysis
---
Upon running floss we see some interesting strings-
![[Pasted image 20230805123708.png]]
`mscorelib` is a part of a C# binary. Thus this is a C# binary and a part of the .NET framework.

<html>
<h2><b><u>Note-</u></b></h2>
C# is part of the .NET framework. C# binaries don't interact directly with the OS but with the .NET framework. C# is executed by the <span style="color:#047c3a">CLR</span>(common Language Runtime). 
After C# is compiled, it is converted to <span style="color:#047c3a">IL</span>(Intermediary Language) which is further run by the CLR.
</html>

Turn on inetsim on REMnux and use DNSspy on flare-vm

On dnspy we get-
![[Pasted image 20230805125553.png]]

The dll has two classes - `Cryptor` and `Program`
![[Pasted image 20230805125730.png]]
`Cryptor`-
![[Pasted image 20230805125808.png]]
`Program`-
![[Pasted image 20230805125837.png]]
We see a base64 string in `Program` function.
![[Pasted image 20230805130023.png]]
Also a xml and a vbs file is being created.
Now we run the dll using <span style="color:#ffff00">rundll32</span> and the main method of the dll - `embed`.

		 rundll32.exe .\Malware.cryptlib64.dll,embed

After running, we find the xml file -
![[Pasted image 20230805130555.png]]
![[Pasted image 20230805130630.png]]
Also a registry key has been created by the dll pointing to the vbs file-
![[Pasted image 20230805130900.png]]
The xml file is using MSBuild to execute malware. Running it-
![[Pasted image 20230805131258.png]]
It is requesting for something off of -`http://ocsp.digicert.com` and `srv.masterchiefsgruntemporium.local`.
<br>

# Conclusion
---
This is a C2 dropper from the Covenant C2 framework. When run, a grunt from the c2 framework will deliver the malware to the system.