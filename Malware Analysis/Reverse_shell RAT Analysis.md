<br>

# Sample Information
------
<b><u>Malware used</b></u>- <font color =Cyan> RAT.Unknown.2.exe.malz </font>
Type - <span style="color:#c00000">Remote Access Trojan</span>
<br>

# Static Analysis
------
### Floss-

##### command used-

		floss .\RAT.Unknown.2.exe.malz

![[Pasted image 20230726234315.png]]

##### Output-
No interesting strings

### Pestudio

![[Pasted image 20230727101950.png]]
<br>

# Dynamic Analysis
----
Upon detonation of malware, we see some dns requests made by the malware.
![[Pasted image 20230727104428.png]]
![[Pasted image 20230727104557.png]]
We didn't find any strings before running the malware because this malware generates strings at runtime.In order to resolve this domain, we can edit the hosts file on the windows machine using the command -

		nano C:\Windows\System32\drivers\etc\hosts

![[Pasted image 20230727105749.png]]
Then we observe the processes made using <span style="color:#ffff00">procmon</span>.
![[Pasted image 20230727110625.png]]
![[Pasted image 20230727110754.png]]
A few processes have opened up with the tcp connection pointing to the https port of the "malicious domain server". Now as we have configured the domain server to point to us, we can open <span style="color:#ffff00">netcat</span> on the windows vm to see what it is reaching to.

		ncat -lvnp 443

Now executing the malware, we get a connection back on netcat indicating that it is a reverse shell.
![[Pasted image 20230727111327.png]]

<span style="color:#c00000">REVERSE SHELL CAPABILITY CONFIRMED!!</span>
<BR>

# Reverse Shell Analysis
------
Removing TCP filter in procmon to broaden out searching-
![[Pasted image 20230727121236.png]]
In order to better see the processes of the malware, we can click on process tree to get a better gist of processes.
![[Pasted image 20230727121650.png]]
We see that the malware is actually a sub-process of explorer.exe (Process that spawns all interactive things in windows).

When issued a command by the attacker, the RAT spawns a cmd.exe under explorer.exe and after that spawns a child process under it with the command issued.

Another way to look for processes would be to add a PPID(Parent process id) filter in procmon.

![[Pasted image 20230727122625.png]]
