<br>

# Malware Details
-----
Name - <span style="color:#00b0f0">unknown.exe.malz</span>
Type - <span style="color:#c00000">Data stealer</span>

# Hashes
-----
### MD5-

		MD5sum.exe unknown.exe.malz

`b9497ffb7e9c6f49823b95851ec874e3`

### SHA256-

		sha256.exe unknown.exe.malz

`3aca2a08cf296f1845d6171958ef0ffd1c8bdfc3e48bdd34a605cb1f7468213e`

On Virustotal we get -

![[Pasted image 20230730225438.png]]

Sample architecture - <span style="color:#7030a0">x86_64 (64 bit) for windows</span>
<br>

# Simple Static Analysis
-----
### Strings-

Tools used - <span style="color:#ffff00">floss</span>

		 floss .\unknown.exe.malz > floss.txt

Interesting Strings-

```
@Desktop\cosmo.jpeg
@SikoMode
@Mozilla/5.0
@C:\Users\Public\passwrd.txt
```

![[Pasted image 20230730230657.png]]

### IAT Analysis -

Tools used - <span style="color:#ffff00">Pestudio</span> 

![[Pasted image 20230730231056.png]]

![[Pasted image 20230730231135.png]]
The malware is developed for 64 bit windows systems.
![[Pasted image 20230730231238.png]]
![[Pasted image 20230730231353.png]]

Now checking whether the sample is packed or unpacked--->
Checking IMAGE_SECTION_HEADER.text - 

![[Pasted image 20230730231623.png]]

This malware doesn't seem to import any libraries or APIs. So moving onto further analysis using <span style="color:#ffff00">pestudio</span>.

Tools used - <span style="color:#ffff00">pestudio</span>

![[Pasted image 20230730232024.png]]
![[Pasted image 20230730232051.png]]
![[Pasted image 20230730232145.png]]

There doesn't seem to be much being revealed using simple static analysis. So we move onto simple dynamic analysis.
<br>

# Simple Dynamic Analysis
-----

### Initial Detonation-

Without network - 

The malware deletes itself.

With Network - 

Nothing seems to be happenning at first but after some time , it deletes itself.
![[Pasted image 20230730234043.png]]

### Network Analysis - 

On detonation, the malware is seemingly reaching out to a site and getting some posts.
![[Pasted image 20230731153445.png]]

It is also reaching out to a DNS address named-  `cdn.altimiter.local`

![[Pasted image 20230731153829.png]]

We edit the hosts file in windows to point to the above dns address.

Now looking onto the post requests , we notice that the malware is reaching out to multiple posts at a regular time interval.
![[Pasted image 20230731154221.png]]

Now starting <span style="color:#ffff00">procmon</span> to monitor processes made by the malware.

Tools used - <span style="color:#ffff00">procmon</span>

![[Pasted image 20230731155555.png]]

![[Pasted image 20230731155700.png]]
In strings we had a path to a passwrd.txt . Applying a filter --->
![[Pasted image 20230731155852.png]]

![[Pasted image 20230731155945.png]]

On opening the file , we have only one word - `sikomode`
![[Pasted image 20230731160125.png]]

This isn't going anywhere. So moving onto using <span style="color:#ffff00">tcpview</span>-
![[Pasted image 20230731160448.png]]
We get a connection from the malware to local port <span style="color:#7030a0">50602</span>.
Maybe it is a reverse shell.Opening ncat on port 50602.

![[Pasted image 20230731160741.png]]
No response. Maybe it is using https.
Using ncat with ssl. Still no response.
![[Pasted image 20230731160914.png]]
So maybe the malware was exfiltrating data using the feed http requests.
Moving onto Advanced static analysis.

```
Q: What is the significance of `houdini`?

A: `houdini` refers to the method call that makes the binary delete itself from disk. This method call is invoked in a few different instances, which are covered in the third question in this challenge. This method call can be observed in the strings of the binary and in the decompiled output in Cutter.

```
<br>

# Advances Static Analysis
------
Tools used - <span style="color:#ffff00">cutter</span>

We are greeted with this window - 
![[Pasted image 20230731162204.png]]
The malware is written in nim.

![[Pasted image 20230731190421.png]]

The function responsible for exfiltration of data.
![[Pasted image 20230731191629.png]]
Houdini is being called here.

Nim main module--->
![[Pasted image 20230731191821.png]]
![[Pasted image 20230731191841.png]]
