<br>

# Introduction
------
Basic Dynamic Analysis is the method of examining a malware while running. It is also known as <font color=green><b>Heuristic</b></font> or <font color=green><b>Behaviourial</b></font> analysis. It is a limited form of triage. It tells us a lot about the host and network indicators.
<br>

# Host And Network Based Indicators
------
<font color=green><b>Host based Indicators</b></font> are the actions the malware takes while modifying or interacting with the host. They can be pulled from the host based logs.

Example- Creating a file,modifying a service,etc.

<font color=green><b>Network based indicators</b></font> are the action the malware takes when interacting with the network or the internet. They can be pulled from network logs.

Example- Downloading a second stage,uploading data,etc.
<br>

# Hunting for network signatures
------
<h3><b><u>NOTE</u>-</b></h3> 
Before initial detonation, be sure to <b> KEEP ALL REQUIRED TOOLS UP AND RUNNING</b> . If the malware detects itself in a sandbox,it may try to sabotage the analysis which is detrimental to the triage.

### Simulating a network-

Fire up Remnux vm which is in networked in the same network as the flarevm box.

![[Pasted image 20230726153724.png]]

Then start <font color=green><b>Inetsim</b></font> on REMnux using the following command-

		inetsim

![[Pasted image 20230726153845.png]]

Confirm that intsim is up and running.

![[Pasted image 20230726153947.png]]

It is up and running.Now to capture network traffic generated by the malware,we need to setup <font color=green><b>wireshark</b></font> on the REMnux box. Start it by typing-

		sudo wireshark

![[Pasted image 20230726154906.png]]
![[Pasted image 20230726154624.png]]

Now click on the desired network interface to capture traffic.In my case it is enp0s3 .

![[Pasted image 20230726154816.png]]

Here traffic will be seen. For more information on display filters,see -
https://wiki.wireshark.org/DisplayFilters
Now we can move on to analysis of the malware.

### Detonation-

Change the file extension to .exe to make it a portable executable file.

![[Pasted image 20230726155123.png]]
After detonation , we capture a request in wireshark.

![[Pasted image 20230726155953.png]]

![[Pasted image 20230726160044.png]]
Fig: The network signature of the malware.

Thus we get the network signature of the malware.
<br>

# Hunting for host based signatures
-----
<font color=green><b>Procmon</b></font> will be used to analyse host based signatures of the malware.
The sysinternals utility set will be used heavily in signature detection of malwares.

![[Pasted image 20230726164258.png]]
![[Pasted image 20230726164558.png]]
Fig: Applying filter for malware executable

After detonation,we get a list of what the malware has done chronological wise.

![[Pasted image 20230726171308.png]]

Add a filter to monitor file changes-

![[Pasted image 20230726172430.png]]
![[Pasted image 20230726172526.png]]
We find all kinds of interesting changes done by the malware.For example, we see that the malware has created an executable named dat.exe .
![[Pasted image 20230726173010.png]]

Opening the file location :-
![[Pasted image 20230726173500.png]]

If inetsim isn't running,the malware deletes itself from the disk. We can capture that signature using these filters-

![[Pasted image 20230726181907.png]]
![[Pasted image 20230726182422.png]]
<br>

### Internal network signatures on the host

In order to analyse the connections made by the malware internally, <font color=green><b>TCPview</b></font> is used. It is a part of the sysinternals suite.
![[Pasted image 20230726222847.png]]
We need to look out for <font color=green><b>TCP artifacts</b></font> such as open sockets or tcp connections.
![[Pasted image 20230726223816.png]]
We see that the malware has opened up a listening port on TCP : 5555.
Thus we use netcat to connect to the port using the command-

		nc -nv 10.0.0.4 5555

## What we concluded so far-

![[Pasted image 20230726182700.png]]
We have concluded so far that the above malware is a malware dropper a.k.a when run,it reaches for the real malicious malware ,downloads it and runs it on the system.
<br>

